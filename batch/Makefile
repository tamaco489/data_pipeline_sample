# =====================================================================================
# Batch Scripts Management
# =====================================================================================

# S3ãƒã‚±ãƒƒãƒˆåï¼ˆç’°å¢ƒã«å¿œã˜ã¦å¤‰æ›´ã—ã¦ãã ã•ã„ï¼‰
S3_BUCKET_NAME ?= stg-data-pipeline-sample-glue-job-script

# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
.PHONY: help
help: ## Display available commands
	@echo "Available commands:"
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | sort | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-20s\033[0m %s\n", $$1, $$2}'

.PHONY: upload-all-scripts
upload-all-scripts: ## Upload all ETL scripts to S3
	@echo "ğŸš€ Starting ETL scripts upload to S3..."
	@echo ""
	@echo "ğŸ“ Core DB ETL..."
	@$(MAKE) -s -C core_db_etl upload-script
	@echo "ğŸ“Š Sales Analytics..."
	@$(MAKE) -s -C sales_analytics upload-script
	@echo ""
	@echo "âœ… All ETL scripts uploaded successfully!"

.PHONY: delete-all-scripts
delete-all-scripts: ## Delete all ETL scripts from S3
	@echo "ğŸ—‘ï¸ Starting ETL scripts deletion from S3..."
	@echo ""
	@echo "ğŸ“ Core DB ETL..."
	@$(MAKE) -s -C core_db_etl delete-script
	@echo "ğŸ“Š Sales Analytics..."
	@$(MAKE) -s -C sales_analytics delete-script
	@echo ""
	@echo "âœ… All ETL scripts deleted successfully!"

.PHONY: clean-all
clean-all: ## Clean temporary files in all directories
	@echo "ğŸ§¹ Cleaning all temporary files..."
	$(MAKE) -C core_db_etl clean
	$(MAKE) -C sales_analytics clean
	@echo "All clean operations completed!"

.PHONY: clean
clean: clean-all ## Clean temporary files (alias)

# å€‹åˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ“ä½œ
.PHONY: core-db-etl
core-db-etl: ## Core DB ETL script operations
	@echo "Core DB ETL operations:"
	@echo "  make -C core_db_etl help"

.PHONY: sales-analytics
sales-analytics: ## Sales Analytics script operations
	@echo "Sales Analytics operations:"
	@echo "  make -C sales_analytics help"
